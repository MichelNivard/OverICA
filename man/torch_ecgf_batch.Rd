% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/utils.R
\name{torch_ecgf_batch}
\alias{torch_ecgf_batch}
\title{Compute Empirical Cumulative Generating Function (ECGF) and its Derivatives}
\usage{
torch_ecgf_batch(t_vectors, data_tensor)
}
\arguments{
\item{t_vectors}{A tensor of shape \code{(num_t_vals, p)}, where \code{num_t_vals} is the number of t-values and \code{p} is the dimensionality.}

\item{data_tensor}{A tensor of shape \code{(n, p)}, where \code{n} is the number of data points and \code{p} is the dimensionality.}
}
\value{
A list containing:
\item{K}{A tensor of shape \code{(num_t_vals)} representing the ECGF values.}
\item{dK}{A tensor of shape \code{(num_t_vals, p)} representing the first derivative of the ECGF.}
\item{d2K}{A tensor of shape \code{(num_t_vals, p, p)} representing the second derivative of the ECGF.}
}
\description{
This function calculates the Empirical Cumulative Generating Function (ECGF) and its first
and second derivatives using a batch of data. It is designed to work with torch tensors.
}
\details{
The function computes the ECGF using the dot product between the data tensor and t-vectors, followed by the calculation of log-sum-exp for numerical stability.
The first derivative \code{dK} is obtained using weighted averages of the data points. The second derivative \code{d2K} is computed through a batch of weighted centered data products.
}
\examples{
\dontrun{
# Assume torch and appropriate tensors are loaded
t_vectors <- torch_randn(c(5, 3)) # 5 t-values, 3-dimensional space
data_tensor <- torch_randn(c(100, 3)) # 100 data points, 3-dimensional space
result <- torch_ecgf_batch(t_vectors, data_tensor)
print(result$K)  # ECGF values
print(result$dK) # First derivative
print(result$d2K) # Second derivative
}

}
